{"version":3,"sources":["../../../../src/commands/run/utils/resolvePortAsync.ts"],"names":["resolvePortAsync","projectRoot","defaultPort","port","parseInt","getenv","int","resolvedPort","Log","log","process","env","RCT_METRO_PORT","String"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AAEO,eAAeA,gBAAf,CACLC,WADK,EAELC,WAFK,EAGmB;AACxB,MAAIC,IAAJ;;AACA,MAAI,OAAOD,WAAP,KAAuB,QAA3B,EAAqC;AACnCC,IAAAA,IAAI,GAAGC,QAAQ,CAACF,WAAD,EAAc,EAAd,CAAf;AACD,GAFD,MAEO,IAAI,OAAOA,WAAP,KAAuB,QAA3B,EAAqC;AAC1CC,IAAAA,IAAI,GAAGD,WAAP;AACD,GAFM,MAEA;AACLC,IAAAA,IAAI,GAAGE,kBAAOC,GAAP,CAAW,gBAAX,EAA6B,IAA7B,CAAP;AACD,GARuB,CAUxB;;;AACA,QAAMC,YAAY,GAAG,MAAM,wCAAgBN,WAAhB,EAA6BE,IAA7B,CAA3B;;AACA,MAAII,YAAY,IAAI,IAApB,EAA0B;AACxBC,mBAAIC,GAAJ,CAAQ,4BAAR,EADwB,CAExB;;AACD,GAHD,MAGO;AACL;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYC,cAAZ,GAA6BC,MAAM,CAACN,YAAD,CAAnC;AACD;;AAED,SAAOA,YAAP;AACD","sourcesContent":["import getenv from 'getenv';\nimport { choosePortAsync } from 'xdl/build/utils/choosePortAsync';\n\nimport Log from '../../../log';\n\nexport async function resolvePortAsync(\n  projectRoot: string,\n  defaultPort?: string | number\n): Promise<number | null> {\n  let port: number;\n  if (typeof defaultPort === 'string') {\n    port = parseInt(defaultPort, 10);\n  } else if (typeof defaultPort === 'number') {\n    port = defaultPort;\n  } else {\n    port = getenv.int('RCT_METRO_PORT', 8081);\n  }\n\n  // Only check the port when the bundler is running.\n  const resolvedPort = await choosePortAsync(projectRoot, port);\n  if (resolvedPort == null) {\n    Log.log('\\u203A Skipping dev server');\n    // Skip bundling if the port is null\n  } else {\n    // Use the new or resolved port\n    process.env.RCT_METRO_PORT = String(resolvedPort);\n  }\n\n  return resolvedPort;\n}\n"],"file":"resolvePortAsync.js"}